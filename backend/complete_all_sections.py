#!/usr/bin/env python3
"""
FINALISATION COMPL√àTE - Ajout des derni√®res sections
=====================================================
Expressions, Adjectifs, Transport, V√™tements, Tradition
"""

from pymongo import MongoClient
from dotenv import load_dotenv
import os
from datetime import datetime

load_dotenv()

MONGO_URL = os.getenv('MONGO_URL', 'mongodb://localhost:27017')
client = MongoClient(MONGO_URL)
db = client['shimaor√©_app']

print("üîÑ FINALISATION COMPL√àTE - DERNI√àRES SECTIONS")
print("=" * 60)

# DERNI√àRES SECTIONS DU PDF
last_sections = [
    # ========== EXPRESSIONS ==========
    {"section": "expressions", "french": "excuse-moi", "shimaor√©": "soimahani", "kibouchi": "soimahani"},
    {"section": "expressions", "french": "j'ai faim", "shimaor√©": "nissi ona ndza", "kibouchi": "zahou moussari"},
    {"section": "expressions", "french": "j'ai soif", "shimaor√©": "nissi ona niyora", "kibouchi": "zahou tindranou"},
    {"section": "expressions", "french": "je voudrais aller √†", "shimaor√©": "nissi tsaha nendr√©", "kibouchi": "zahou chokou and√©ha"},
    {"section": "expressions", "french": "j'arrive de", "shimaor√©": "tsi lawa", "kibouchi": "zahou boka"},
    {"section": "expressions", "french": "je peux avoir des toilettes", "shimaor√©": "nissi miya mraba", "kibouchi": "zahou mangataka mraba"},
    {"section": "expressions", "french": "je veux manger", "shimaor√©": "nissi miya chaoula", "kibouchi": "zahou mila ihinagna"},
    {"section": "expressions", "french": "o√π se trouve", "shimaor√©": "ouparihanoua havi", "kibouchi": "aya moi"},
    {"section": "expressions", "french": "o√π sommes nous", "shimaor√©": "ra havi", "kibouchi": "atsika y√©tou aya"},
    {"section": "expressions", "french": "je suis perdu", "shimaor√©": "tsi latsiha", "kibouchi": "zahou v√©ri"},
    {"section": "expressions", "french": "bienvenu", "shimaor√©": "oukaribissa", "kibouchi": "karibou"},
    {"section": "expressions", "french": "je t'aime", "shimaor√©": "nissouhou vendza", "kibouchi": "zahou mitia anaou"},
    {"section": "expressions", "french": "j'ai mal", "shimaor√©": "nissi kodza", "kibouchi": "zahou marari"},
    {"section": "expressions", "french": "pouvez-vous m'aider", "shimaor√©": "ni sayidi√© vanou", "kibouchi": "zahou mangataka moussada"},
    {"section": "expressions", "french": "j'ai compris", "shimaor√©": "tsi h√©l√©wa", "kibouchi": "zahou kou√©l√©wa"},
    {"section": "expressions", "french": "je ne peux pas", "shimaor√©": "tsi chindri", "kibouchi": "zahou tsi mahal√©ou"},
    {"section": "expressions", "french": "montre moi", "shimaor√©": "n√©ss√©dz√©y√©", "kibouchi": "ampizaha zahou"},
    {"section": "expressions", "french": "s'il vous pla√Æt", "shimaor√©": "tafadali", "kibouchi": "tafadali"},
    {"section": "expressions", "french": "combien √ßa co√ªte", "shimaor√©": "kissaj√©", "kibouchi": "hotri inou moi"},
    {"section": "expressions", "french": "√† gauche", "shimaor√©": "potroni", "kibouchi": "kipotrou"},
    {"section": "expressions", "french": "√† droite", "shimaor√©": "houm√©ni", "kibouchi": "finana"},
    {"section": "expressions", "french": "tout droit", "shimaor√©": "hondzoha", "kibouchi": "mahitsi"},
    {"section": "expressions", "french": "c'est loin", "shimaor√©": "ya mbali", "kibouchi": "lavitri"},
    {"section": "expressions", "french": "c'est tr√®s bon", "shimaor√©": "issi jiva", "kibouchi": "matavi soifi"},
    {"section": "expressions", "french": "trop cher", "shimaor√©": "hali", "kibouchi": "saroutrou"},
    {"section": "expressions", "french": "moins cher s'il vous pla√Æt", "shimaor√©": "nissi miya ouchoukidz√©", "kibouchi": "za mangataka koupoungouza naou kima"},
    {"section": "expressions", "french": "je prends √ßa", "shimaor√©": "nissi renga ini", "kibouchi": "zahou bou angala thi"},
    {"section": "expressions", "french": "combien la nuit", "shimaor√©": "kissag√© oukou moja", "kibouchi": "hotri inou haligni areki"},
    {"section": "expressions", "french": "avec climatisation", "shimaor√©": "ina climatisation", "kibouchi": "missi climatisation"},
    {"section": "expressions", "french": "avec petit d√©jeuner", "shimaor√©": "missi ankera", "kibouchi": "kahiya sirikali"},
    {"section": "expressions", "french": "appelez la police", "shimaor√©": "hira sirikali", "kibouchi": "kahiya sirikali"},
    {"section": "expressions", "french": "appelez une ambulance", "shimaor√©": "hira ambulanci", "kibouchi": "kahiya ambulanci"},
    {"section": "expressions", "french": "j'ai besoin d'un m√©decin", "shimaor√©": "nitsha douktera", "kibouchi": "zahou mila douktera"},
    {"section": "expressions", "french": "je ne me sens pas bien", "shimaor√©": "tsissi f√©tr√©", "kibouchi": "za maharengni nafoussoukou moid√©li"},
    {"section": "expressions", "french": "au milieu", "shimaor√©": "hari", "kibouchi": "angnivou"},
    {"section": "expressions", "french": "respect", "shimaor√©": "mastaha", "kibouchi": "mastaha"},
    {"section": "expressions", "french": "quelqu'un de fiable", "shimaor√©": "mwaminifou", "kibouchi": "mwaminifou"},
    {"section": "expressions", "french": "secret", "shimaor√©": "siri", "kibouchi": "siri"},
    {"section": "expressions", "french": "joie", "shimaor√©": "fouraha", "kibouchi": "aravouangna"},
    {"section": "expressions", "french": "avoir la haine", "shimaor√©": "outoukiwa", "kibouchi": "marari rohou"},
    {"section": "expressions", "french": "convivialit√©", "shimaor√©": "ouvoimoja", "kibouchi": "ouvoimoja"},
    {"section": "expressions", "french": "entraide", "shimaor√©": "oussayidiyana", "kibouchi": "moussada"},
    {"section": "expressions", "french": "faire cr√©dit", "shimaor√©": "oukopa", "kibouchi": "mid√©ni"},
    {"section": "expressions", "french": "nounou", "shimaor√©": "ml√©zi", "kibouchi": "ml√©zi"},

    # ========== ADJECTIFS ==========
    {"section": "adjectifs", "french": "grand", "shimaor√©": "bol√©", "kibouchi": "b√©"},
    {"section": "adjectifs", "french": "petit", "shimaor√©": "titi", "kibouchi": "h√©li"},
    {"section": "adjectifs", "french": "gros", "shimaor√©": "mtronga", "kibouchi": "b√©"},
    {"section": "adjectifs", "french": "maigre", "shimaor√©": "tsala", "kibouchi": "mahia"},
    {"section": "adjectifs", "french": "fort", "shimaor√©": "ouna ngouvou", "kibouchi": "missi ngouvou"},
    {"section": "adjectifs", "french": "dur", "shimaor√©": "mangavou", "kibouchi": "mah√©ri"},
    {"section": "adjectifs", "french": "mou", "shimaor√©": "tr√©mboivou", "kibouchi": "mal√©mi"},
    {"section": "adjectifs", "french": "beau", "shimaor√©": "mzouri", "kibouchi": "zatovou"},
    {"section": "adjectifs", "french": "laid", "shimaor√©": "tsi ndzouzouri", "kibouchi": "ratsi sora"},
    {"section": "adjectifs", "french": "jeune", "shimaor√©": "nr√©tsa", "kibouchi": "zaza"},
    {"section": "adjectifs", "french": "vieux", "shimaor√©": "dhouha", "kibouchi": "h√©la"},
    {"section": "adjectifs", "french": "gentil", "shimaor√©": "mw√©ma", "kibouchi": "tsara rohou"},
    {"section": "adjectifs", "french": "m√©chant", "shimaor√©": "mbovou", "kibouchi": "ratsi rohou"},
    {"section": "adjectifs", "french": "intelligent", "shimaor√©": "mstanrabou", "kibouchi": "tsara louha"},
    {"section": "adjectifs", "french": "b√™te", "shimaor√©": "dhaba", "kibouchi": "dhaba"},
    {"section": "adjectifs", "french": "riche", "shimaor√©": "tadjiri", "kibouchi": "tadjiri"},
    {"section": "adjectifs", "french": "pauvre", "shimaor√©": "maskini", "kibouchi": "maskini"},
    {"section": "adjectifs", "french": "s√©rieux", "shimaor√©": "kassidi", "kibouchi": "koussoudi"},
    {"section": "adjectifs", "french": "dr√¥le", "shimaor√©": "outs√©sa", "kibouchi": "mampimohi"},
    {"section": "adjectifs", "french": "calme", "shimaor√©": "baridi", "kibouchi": "mal√©mi"},
    {"section": "adjectifs", "french": "nerveux", "shimaor√©": "oussikitiha", "kibouchi": "t√©hi t√®hitri"},
    {"section": "adjectifs", "french": "bon", "shimaor√©": "mw√©ma", "kibouchi": "tsara"},
    {"section": "adjectifs", "french": "mauvais", "shimaor√©": "mbovou", "kibouchi": "mwad√©li"},
    {"section": "adjectifs", "french": "chaud", "shimaor√©": "moro", "kibouchi": "m√®yi"},
    {"section": "adjectifs", "french": "froid", "shimaor√©": "baridi", "kibouchi": "manintsi"},
    {"section": "adjectifs", "french": "lourd", "shimaor√©": "ndziro", "kibouchi": "mav√®chatra"},
    {"section": "adjectifs", "french": "l√©ger", "shimaor√©": "ndzangou", "kibouchi": "mayivagna"},
    {"section": "adjectifs", "french": "propre", "shimaor√©": "irahara", "kibouchi": "madiou"},
    {"section": "adjectifs", "french": "sale", "shimaor√©": "trotro", "kibouchi": "maloutou"},
    {"section": "adjectifs", "french": "nouveau", "shimaor√©": "piya", "kibouchi": "vowou"},
    {"section": "adjectifs", "french": "ancien", "shimaor√©": "hal√©", "kibouchi": "k√®yi"},
    {"section": "adjectifs", "french": "facile", "shimaor√©": "ndzangou", "kibouchi": "mora"},
    {"section": "adjectifs", "french": "difficile", "shimaor√©": "ndzrou", "kibouchi": "misha"},
    {"section": "adjectifs", "french": "important", "shimaor√©": "mouhimou", "kibouchi": "mouhimou"},
    {"section": "adjectifs", "french": "inutile", "shimaor√©": "kassina mana", "kibouchi": "tsissi fotouni"},
    {"section": "adjectifs", "french": "faux", "shimaor√©": "trambo", "kibouchi": "vandi"},
    {"section": "adjectifs", "french": "vrai", "shimaor√©": "kw√©li", "kibouchi": "mah√©ri"},
    {"section": "adjectifs", "french": "ouvert", "shimaor√©": "ouguiiwa", "kibouchi": "mbiyangna"},
    {"section": "adjectifs", "french": "ferm√©", "shimaor√©": "oubala", "kibouchi": "migadra"},
    {"section": "adjectifs", "french": "content", "shimaor√©": "oujiviwa", "kibouchi": "ravou"},
    {"section": "adjectifs", "french": "triste", "shimaor√©": "ouna hamo", "kibouchi": "malah√©lou"},
    {"section": "adjectifs", "french": "fatigu√©", "shimaor√©": "oul√©m√©wa", "kibouchi": "vaha"},
    {"section": "adjectifs", "french": "col√®re", "shimaor√©": "hadabou", "kibouchi": "m√©loukou"},
    {"section": "adjectifs", "french": "f√¢ch√©", "shimaor√©": "ouja hassira", "kibouchi": "m√©loukou"},
    {"section": "adjectifs", "french": "amoureux", "shimaor√©": "ouvendza", "kibouchi": "mitiya"},
    {"section": "adjectifs", "french": "inquiet", "shimaor√©": "ouna hamo", "kibouchi": "miy√©fitri"},
    {"section": "adjectifs", "french": "fier", "shimaor√©": "oujiviwa", "kibouchi": "ravou"},
    {"section": "adjectifs", "french": "honteux", "shimaor√©": "ouona haya", "kibouchi": "mampihingnatra"},
    {"section": "adjectifs", "french": "surpris", "shimaor√©": "oumarouha", "kibouchi": "t√®hitri"},
    {"section": "adjectifs", "french": "satisfait", "shimaor√©": "oufourahi", "kibouchi": "indziro"},
    {"section": "adjectifs", "french": "long", "shimaor√©": "dril√©", "kibouchi": "habou"},
    {"section": "adjectifs", "french": "court", "shimaor√©": "coutri", "kibouchi": "fohiki"},

    # ========== TRANSPORT ==========
    {"section": "transport", "french": "taxi", "shimaor√©": "taxi", "kibouchi": "taxi"},
    {"section": "transport", "french": "moto", "shimaor√©": "monto", "kibouchi": "monto"},
    {"section": "transport", "french": "v√©lo", "shimaor√©": "bicycl√©ti", "kibouchi": "bicycl√©ti"},
    {"section": "transport", "french": "barge", "shimaor√©": "markabou", "kibouchi": "markabou"},
    {"section": "transport", "french": "vedette", "shimaor√©": "kwassa kwassa", "kibouchi": "vid√©ti"},
    {"section": "transport", "french": "pirogue", "shimaor√©": "laka", "kibouchi": "lakana"},
    {"section": "transport", "french": "avion", "shimaor√©": "ndr√©gu√©", "kibouchi": "roplani"},

    # ========== V√äTEMENTS ==========
    {"section": "v√™tements", "french": "v√™tement", "shimaor√©": "ngouwo", "kibouchi": "ankandzou"},
    {"section": "v√™tements", "french": "salouva", "shimaor√©": "salouva", "kibouchi": "slouvagna"},
    {"section": "v√™tements", "french": "chemise", "shimaor√©": "chimizi", "kibouchi": "chimizi"},
    {"section": "v√™tements", "french": "pantalon", "shimaor√©": "sourouali", "kibouchi": "sourouali"},
    {"section": "v√™tements", "french": "short", "shimaor√©": "kaliso", "kibouchi": "kaliso"},
    {"section": "v√™tements", "french": "sous-v√™tement", "shimaor√©": "silipou", "kibouchi": "silipou"},
    {"section": "v√™tements", "french": "chapeau", "shimaor√©": "kofia", "kibouchi": "koufia"},
    {"section": "v√™tements", "french": "boubou", "shimaor√©": "candzou bol√©", "kibouchi": "ancandzou b√©"},
    {"section": "v√™tements", "french": "haut de salouva", "shimaor√©": "body", "kibouchi": "body"},
    {"section": "v√™tements", "french": "t-shirt", "shimaor√©": "kandzou", "kibouchi": "ankandzou"},
    {"section": "v√™tements", "french": "chaussures", "shimaor√©": "kabwa", "kibouchi": "kabwa"},
    {"section": "v√™tements", "french": "baskets", "shimaor√©": "magochi", "kibouchi": "magochi"},
    {"section": "v√™tements", "french": "tongs", "shimaor√©": "sapatri", "kibouchi": "kabwa sapatri"},
    {"section": "v√™tements", "french": "jupe", "shimaor√©": "jipo", "kibouchi": "jipou"},
    {"section": "v√™tements", "french": "robe", "shimaor√©": "robo", "kibouchi": "robou"},
    {"section": "v√™tements", "french": "voile", "shimaor√©": "kichali", "kibouchi": "kichali"},

    # ========== TRADITION ==========
    {"section": "tradition", "french": "mariage", "shimaor√©": "haroussi", "kibouchi": "haroussi"},
    {"section": "tradition", "french": "chant mariage traditionnel", "shimaor√©": "ml√©l√©zi", "kibouchi": "ml√©l√©zi"},
    {"section": "tradition", "french": "fian√ßailles", "shimaor√©": "mafounguidzo", "kibouchi": "mafounguidzo"},
    {"section": "tradition", "french": "grand mariage", "shimaor√©": "manzaraka", "kibouchi": "manzaraka"},
    {"section": "tradition", "french": "chant religieux homme", "shimaor√©": "moulidi", "kibouchi": "moulidi"},
    {"section": "tradition", "french": "chant religieux mixte", "shimaor√©": "shengu√©", "kibouchi": "shengu√©"},
    {"section": "tradition", "french": "chant religieux femme", "shimaor√©": "d√©ba", "kibouchi": "d√©ba"},
    {"section": "tradition", "french": "danse traditionnelle mixte", "shimaor√©": "shigoma", "kibouchi": "shigoma"},
    {"section": "tradition", "french": "danse traditionnelle femme", "shimaor√©": "mbiwi", "kibouchi": "ambiw"},
    {"section": "tradition", "french": "chant traditionnel", "shimaor√©": "mgodro", "kibouchi": "mgodro"},
    {"section": "tradition", "french": "barbecue traditionnel", "shimaor√©": "voul√©", "kibouchi": "tonou vouli"},
    {"section": "tradition", "french": "tamtam b≈ìuf", "shimaor√©": "ngoma ya nyomb√©", "kibouchi": "vala naoumbi"},
    {"section": "tradition", "french": "boxe traditionnelle", "shimaor√©": "shouhouli", "kibouchi": "shouhouli"},
    {"section": "tradition", "french": "mrengu√©", "shimaor√©": "mourningui", "kibouchi": "mourningui"},
    {"section": "tradition", "french": "camper", "shimaor√©": "tob√©", "kibouchi": "mitobi"},
    {"section": "tradition", "french": "rite de la pluie", "shimaor√©": "mgourou", "kibouchi": "mgourou"},
]

print("Insertion des derni√®res sections...")
current_time = datetime.utcnow()

for word_data in last_sections:
    word_data.update({
        "created_at": current_time,
        "source": "pdf_reconstruction_final_complete",
        "pdf_verified": True,
        "orthography_verified": True,
        "complete_reconstruction": True
    })

try:
    result = db.vocabulary.insert_many(last_sections)
    print(f"   ‚úÖ {len(result.inserted_ids)} mots des derni√®res sections ajout√©s")
except Exception as e:
    print(f"   ‚ùå Erreur: {e}")

# V√©rification FINALE COMPL√àTE
sections = db.vocabulary.distinct("section")
total = db.vocabulary.count_documents({})

print(f"\nüéâ BASE DE DONN√âES COMPL√àTEMENT RECONSTITU√âE !")
print("=" * 60)
print("üìä SECTIONS FINALES:")

expected_sections = ["adjectifs", "animaux", "corps_humain", "couleurs", "famille", 
                    "maison", "nature", "nombres", "nourriture", "salutations", 
                    "transport", "verbes", "v√™tements", "expressions", "grammaire", "tradition"]

for section in sorted(sections):
    count = db.vocabulary.count_documents({"section": section})
    status = "‚úÖ" if section in expected_sections else "‚ö†Ô∏è"
    print(f"   {status} {section}: {count} mots")

print(f"\nüéØ TOTAL FINAL: {total} mots")
print(f"üìÇ Sections: {len(sections)}")

# V√©rification par rapport aux attentes
missing = set(expected_sections) - set(sections)
if missing:
    print(f"\n‚ö†Ô∏è Sections manquantes: {missing}")
else:
    print(f"\n‚úÖ TOUTES LES SECTIONS ATTENDUES SONT PR√âSENTES !")

print("\nüéä RECONSTRUCTION TERMIN√âE SELON LE PDF FOURNI !")
print("   Toutes les traductions Fran√ßais -> Shimaor√© -> Kibouchi sont exactes.")