#!/usr/bin/env python3
"""
Script pour mettre √† jour les sections "chiffres" et "animaux" avec les donn√©es exactes des images fournies
"""

import os
from pymongo import MongoClient
from datetime import datetime

# MongoDB connection
MONGO_URL = os.getenv("MONGO_URL", "mongodb://localhost:27017/mayotte_app")
client = MongoClient(MONGO_URL)
db = client.mayotte_app
words_collection = db.words

def update_chiffres_and_animaux():
    """Mettre √† jour les sections chiffres et animaux avec les donn√©es exactes des images"""
    
    # Supprimer tous les mots existants des cat√©gories "nombres" et "animaux"
    result_delete_chiffres = words_collection.delete_many({"category": "nombres"})
    result_delete_animaux = words_collection.delete_many({"category": "animaux"})
    print(f"üóëÔ∏è Supprim√© {result_delete_chiffres.deleted_count} anciens chiffres")
    print(f"üóëÔ∏è Supprim√© {result_delete_animaux.deleted_count} anciens animaux")
    
    # SECTION CHIFFRES - 20 mots exacts selon l'image
    chiffres_vocabulary = [
        {"french": "un", "shimaore": "moja", "kibouchi": "areki", "category": "chiffre", "image_url": "1Ô∏è‚É£", "difficulty": 1},
        {"french": "deux", "shimaore": "mbili", "kibouchi": "aroyi", "category": "chiffre", "image_url": "2Ô∏è‚É£", "difficulty": 1},
        {"french": "trois", "shimaore": "trarou", "kibouchi": "telou", "category": "chiffre", "image_url": "3Ô∏è‚É£", "difficulty": 1},
        {"french": "quatre", "shimaore": "nh√©", "kibouchi": "efatra", "category": "chiffre", "image_url": "4Ô∏è‚É£", "difficulty": 1},
        {"french": "cinq", "shimaore": "tsano", "kibouchi": "dimi", "category": "chiffre", "image_url": "5Ô∏è‚É£", "difficulty": 1},
        {"french": "six", "shimaore": "sita", "kibouchi": "tchouta", "category": "chiffre", "image_url": "6Ô∏è‚É£", "difficulty": 1},
        {"french": "sept", "shimaore": "saba", "kibouchi": "fitou", "category": "chiffre", "image_url": "7Ô∏è‚É£", "difficulty": 1},
        {"french": "huit", "shimaore": "nan√©", "kibouchi": "valou", "category": "chiffre", "image_url": "8Ô∏è‚É£", "difficulty": 1},
        {"french": "neuf", "shimaore": "chendra", "kibouchi": "civi", "category": "chiffre", "image_url": "9Ô∏è‚É£", "difficulty": 1},
        {"french": "dix", "shimaore": "koumi", "kibouchi": "foulou", "category": "chiffre", "image_url": "üîü", "difficulty": 1},
        {"french": "onze", "shimaore": "koumi na moja", "kibouchi": "foulou areki ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£1Ô∏è‚É£", "difficulty": 2},
        {"french": "douze", "shimaore": "koumi na mbili", "kibouchi": "foulou aroyi ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£2Ô∏è‚É£", "difficulty": 2},
        {"french": "treize", "shimaore": "koumi na trarou", "kibouchi": "foulou telou ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£3Ô∏è‚É£", "difficulty": 2},
        {"french": "quatorze", "shimaore": "koumi na nh√©", "kibouchi": "foulou efatra ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£4Ô∏è‚É£", "difficulty": 2},
        {"french": "quinze", "shimaore": "koumi na tsano", "kibouchi": "foulou dimi ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£5Ô∏è‚É£", "difficulty": 2},
        {"french": "seize", "shimaore": "koumi na sita", "kibouchi": "foulou tchouta ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£6Ô∏è‚É£", "difficulty": 2},
        {"french": "dix-sept", "shimaore": "koumi na saba", "kibouchi": "foulou fitou ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£7Ô∏è‚É£", "difficulty": 2},
        {"french": "dix-huit", "shimaore": "koumi na nan√©", "kibouchi": "foulou valou ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£8Ô∏è‚É£", "difficulty": 2},
        {"french": "dix-neuf", "shimaore": "koumi na chendra", "kibouchi": "foulou civi ambi", "category": "chiffre", "image_url": "1Ô∏è‚É£9Ô∏è‚É£", "difficulty": 2},
        {"french": "vingt", "shimaore": "chirini", "kibouchi": "arompoulou", "category": "chiffre", "image_url": "2Ô∏è‚É£0Ô∏è‚É£", "difficulty": 2},
    ]
    
    # SECTION ANIMAUX - 68 mots exacts selon l'image
    animaux_vocabulary = [
        {"french": "cochon", "shimaore": "pouroukou", "kibouchi": "lambou", "category": "animal", "image_url": "üê∑", "difficulty": 1},
        {"french": "margouillat", "shimaore": "kasangwe", "kibouchi": "kitsatsaka", "category": "animal", "image_url": "ü¶é", "difficulty": 1},
        {"french": "abeille", "shimaore": "niochi", "kibouchi": "ant√©li", "category": "animal", "image_url": "üêù", "difficulty": 1},
        {"french": "chat", "shimaore": "paha", "kibouchi": "moirou", "category": "animal", "image_url": "üê±", "difficulty": 1},
        {"french": "rat", "shimaore": "pouhou", "kibouchi": "voilavou", "category": "animal", "image_url": "üê≠", "difficulty": 1},
        {"french": "escargot", "shimaore": "kwa", "kibouchi": "ancora", "category": "animal", "image_url": "üêå", "difficulty": 1},
        {"french": "lion", "shimaore": "simba", "kibouchi": "simba", "category": "animal", "image_url": "ü¶Å", "difficulty": 1},
        {"french": "grenouille", "shimaore": "shiwatrotro", "kibouchi": "sahougnou", "category": "animal", "image_url": "üê∏", "difficulty": 1},
        {"french": "oiseau", "shimaore": "gnougni", "kibouchi": "vorougnou", "category": "animal", "image_url": "üê¶", "difficulty": 1},
        {"french": "chien", "shimaore": "mbwa", "kibouchi": "fadroka", "category": "animal", "image_url": "üê∂", "difficulty": 1},
        {"french": "poisson", "shimaore": "fi", "kibouchi": "lokou", "category": "animal", "image_url": "üêü", "difficulty": 1},
        {"french": "maki", "shimaore": "komba", "kibouchi": "amkoumba", "category": "animal", "image_url": "üêí", "difficulty": 1},
        {"french": "ch√®vre", "shimaore": "mbouzi", "kibouchi": "bengui", "category": "animal", "image_url": "üêê", "difficulty": 1},
        {"french": "moustique", "shimaore": "manundi", "kibouchi": "mokou", "category": "animal", "image_url": "ü¶ü", "difficulty": 1},
        {"french": "mouche", "shimaore": "ndzi", "kibouchi": "lalitri", "category": "animal", "image_url": "ü™∞", "difficulty": 1},
        {"french": "chauve souris", "shimaore": "drema", "kibouchi": "fanihi", "category": "animal", "image_url": "ü¶á", "difficulty": 1},
        {"french": "serpent", "shimaore": "nyoha", "kibouchi": "bibi lava", "category": "animal", "image_url": "üêç", "difficulty": 1},
        {"french": "lapin", "shimaore": "sungura", "kibouchi": "shoungoura", "category": "animal", "image_url": "üê∞", "difficulty": 1},
        {"french": "canard", "shimaore": "guisi", "kibouchi": "doukitri", "category": "animal", "image_url": "ü¶Ü", "difficulty": 1},
        {"french": "mouton", "shimaore": "baribari", "kibouchi": "baribari", "category": "animal", "image_url": "üêë", "difficulty": 1},
        {"french": "crocodile", "shimaore": "vwai", "kibouchi": "vwai", "category": "animal", "image_url": "üêä", "difficulty": 1},
        {"french": "cam√©l√©on", "shimaore": "tarundru", "kibouchi": "tarondru", "category": "animal", "image_url": "ü¶é", "difficulty": 1},
        {"french": "z√©bu", "shimaore": "nyomb√©", "kibouchi": "aoumbi", "category": "animal", "image_url": "üêÇ", "difficulty": 1},
        {"french": "√¢ne", "shimaore": "pundra", "kibouchi": "ampundra", "category": "animal", "image_url": "ü´è", "difficulty": 1},
        {"french": "poule", "shimaore": "kouhou", "kibouchi": "akohou", "category": "animal", "image_url": "üêî", "difficulty": 1},
        {"french": "pigeon", "shimaore": "ndiwa", "kibouchi": "indiwa", "category": "animal", "image_url": "üïäÔ∏è", "difficulty": 1},
        {"french": "fourmis", "shimaore": "tsossou", "kibouchi": "vitsiki", "category": "animal", "image_url": "üêú", "difficulty": 1},
        {"french": "chenille", "shimaore": "bazi", "kibouchi": "bibimanguidi", "category": "animal", "image_url": "üêõ", "difficulty": 1},
        {"french": "papillon", "shimaore": "pelapelaka", "kibouchi": "tsipelapelaka", "category": "animal", "image_url": "ü¶ã", "difficulty": 1},
        {"french": "ver de terre", "shimaore": "lingoui lingoui", "kibouchi": "bibi fotaka", "category": "animal", "image_url": "ü™±", "difficulty": 1},
        {"french": "criquet", "shimaore": "furudji", "kibouchi": "kidzedza", "category": "animal", "image_url": "ü¶ó", "difficulty": 1},
        {"french": "cheval", "shimaore": "poundra", "kibouchi": "farassi", "category": "animal", "image_url": "üê¥", "difficulty": 1},
        {"french": "fruit du jaquier", "shimaore": "f√©n√©ssi", "kibouchi": "fin√©ssi", "category": "animal", "image_url": "ü•≠", "difficulty": 1},
        {"french": "perroquet", "shimaore": "kasoukou", "kibouchi": "kararokou", "category": "animal", "image_url": "ü¶ú", "difficulty": 1},
        {"french": "cafard", "shimaore": "kalalawi", "kibouchi": "kalalowou", "category": "animal", "image_url": "ü™≥", "difficulty": 1},
        {"french": "araign√©e", "shimaore": "shitrandrabwibwi", "kibouchi": "bibi ampamani massou", "category": "animal", "image_url": "üï∑Ô∏è", "difficulty": 1},
        {"french": "scorpion", "shimaore": "hala", "kibouchi": "hala", "category": "animal", "image_url": "ü¶Ç", "difficulty": 1},
        {"french": "scolopendre", "shimaore": "trambwi", "kibouchi": "trambougnou", "category": "animal", "image_url": "üêõ", "difficulty": 1},
        {"french": "thon", "shimaore": "mbassi", "kibouchi": "mbassi", "category": "animal", "image_url": "üêü", "difficulty": 1},
        {"french": "requin", "shimaore": "papa", "kibouchi": "ankiou", "category": "animal", "image_url": "ü¶à", "difficulty": 1},
        {"french": "poulpe", "shimaore": "pwedza", "kibouchi": "pwedza", "category": "animal", "image_url": "üêô", "difficulty": 1},
        {"french": "crabe", "shimaore": "dradraka", "kibouchi": "dakatra", "category": "animal", "image_url": "ü¶Ä", "difficulty": 1},
        {"french": "tortue", "shimaore": "nyamba/katsa", "kibouchi": "fanou", "category": "animal", "image_url": "üê¢", "difficulty": 1},
        {"french": "bigorno", "shimaore": "trondro", "kibouchi": "trondrou", "category": "animal", "image_url": "üêö", "difficulty": 1},
        {"french": "√©l√©phant", "shimaore": "ndovu", "kibouchi": "ndovu", "category": "animal", "image_url": "üêò", "difficulty": 1},
        {"french": "singe", "shimaore": "djakwe", "kibouchi": "djakouayi", "category": "animal", "image_url": "üêí", "difficulty": 1},
        {"french": "souris", "shimaore": "shikwetse", "kibouchi": "voilavou", "category": "animal", "image_url": "üê≠", "difficulty": 1},
        {"french": "phacoch√®re", "shimaore": "pouruku nyeha", "kibouchi": "lambou", "category": "animal", "image_url": "üêó", "difficulty": 1},
        {"french": "l√©zard", "shimaore": "ngwizi", "kibouchi": "kitsatsaka", "category": "animal", "image_url": "ü¶é", "difficulty": 1},
        {"french": "renard", "shimaore": "mbwa nyeha", "kibouchi": "fandroka", "category": "animal", "image_url": "ü¶ä", "difficulty": 1},
        {"french": "chameau", "shimaore": "ngamia", "kibouchi": "angamia", "category": "animal", "image_url": "üê™", "difficulty": 1},
        {"french": "escargot", "shimaore": "kowa", "kibouchi": "ankora", "category": "animal", "image_url": "üêå", "difficulty": 1},
        {"french": "h√©risson/tangue", "shimaore": "landra", "kibouchi": "trandraka", "category": "animal", "image_url": "ü¶î", "difficulty": 1},
        {"french": "corbeau", "shimaore": "gawa/kwayi", "kibouchi": "gouaka", "category": "animal", "image_url": "üê¶‚Äç‚¨õ", "difficulty": 1},
        {"french": "civette", "shimaore": "founga", "kibouchi": "angava", "category": "animal", "image_url": "ü¶ù", "difficulty": 1},
        {"french": "dauphin", "shimaore": "moungoum√©", "kibouchi": "f√©soutrou", "category": "animal", "image_url": "üê¨", "difficulty": 1},
        {"french": "baleine", "shimaore": "ndroujou", "kibouchi": "", "category": "animal", "image_url": "üêã", "difficulty": 1},
        {"french": "crevette", "shimaore": "camba", "kibouchi": "ancamba", "category": "animal", "image_url": "ü¶ê", "difficulty": 1},
        {"french": "frelon", "shimaore": "chonga", "kibouchi": "faraka", "category": "animal", "image_url": "üêù", "difficulty": 1},
        {"french": "gu√™pe", "shimaore": "movou", "kibouchi": "fanintri", "category": "animal", "image_url": "üêù", "difficulty": 1},
        {"french": "bourdon", "shimaore": "vungo vungo", "kibouchi": "madjaoumbi", "category": "animal", "image_url": "üêù", "difficulty": 1},
        {"french": "puce", "shimaore": "kunguni", "kibouchi": "ancongou", "category": "animal", "image_url": "üêõ", "difficulty": 1},
        {"french": "pou", "shimaore": "ndra", "kibouchi": "howou", "category": "animal", "image_url": "üêõ", "difficulty": 1},
        {"french": "bouc", "shimaore": "b√©w√©", "kibouchi": "b√©berou", "category": "animal", "image_url": "üêê", "difficulty": 1},
        {"french": "taureau", "shimaore": "kondzo", "kibouchi": "dzow", "category": "animal", "image_url": "üêÇ", "difficulty": 1},
        {"french": "bigorneau", "shimaore": "trondro", "kibouchi": "trondrou", "category": "animal", "image_url": "üêö", "difficulty": 1},
        {"french": "lambis", "shimaore": "komb√©", "kibouchi": "mahombi", "category": "animal", "image_url": "üêö", "difficulty": 1},
        {"french": "c√¥ne de mer", "shimaore": "kwitsi", "kibouchi": "tsimtipaka", "category": "animal", "image_url": "üêö", "difficulty": 1},
        {"french": "mille pattes", "shimaore": "gnamar√©", "kibouchi": "kamara", "category": "animal", "image_url": "üêõ", "difficulty": 1},
        {"french": "oursin", "shimaore": "mjongo", "kibouchi": "acoudafitri", "category": "animal", "image_url": "ü¶î", "difficulty": 1},
        {"french": "hu√Ætre", "shimaore": "gadzassi", "kibouchi": "vouli vavi", "category": "animal", "image_url": "ü¶™", "difficulty": 1},
    ]
    
    # Ajouter timestamp √† chaque mot
    all_vocabulary = chiffres_vocabulary + animaux_vocabulary
    for word in all_vocabulary:
        word["created_at"] = datetime.utcnow()
    
    # Ins√©rer tous les nouveaux mots
    result = words_collection.insert_many(all_vocabulary)
    
    print(f"‚úÖ Sections chiffres et animaux mises √† jour : {len(result.inserted_ids)} mots ajout√©s")
    print(f"üìä Chiffres : {len(chiffres_vocabulary)} mots")
    print(f"üìä Animaux : {len(animaux_vocabulary)} mots")
    
    # V√©rification
    total_words = words_collection.count_documents({})
    chiffres_count = words_collection.count_documents({"category": "chiffre"})
    animaux_count = words_collection.count_documents({"category": "animal"})
    
    print(f"\nüìà STATISTIQUES MISES √Ä JOUR :")
    print(f"   Total des mots dans la base : {total_words}")
    print(f"   Mots dans la cat√©gorie chiffre : {chiffres_count}")
    print(f"   Mots dans la cat√©gorie animal : {animaux_count}")
    
    return len(result.inserted_ids)

if __name__ == "__main__":
    print("üîÑ Mise √† jour des sections chiffres et animaux avec les donn√©es des images...")
    count = update_chiffres_and_animaux()
    print(f"‚úÖ Termin√© ! {count} mots (chiffres + animaux) mis √† jour selon les images.")